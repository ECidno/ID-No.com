{% extends 'default.html.twig' %}
{% block title %}{{ 'meinidno.title'|trans }}{% endblock %}

{# content #}
{% block content %}
  <div class="container-fluid">
    <div class="row my-3 justify-content-center">
      <div id="myIdNoHeader" class="col-12 col-md-10 col-lg-8">
        <h1>{{ 'meinidno.title'|trans }}</h1>
      </div>
    </div>

{#
    <form
      method="post"
      class="ajax-upload"
      name="upload"
      action="{{ path('app_api_person_upload', { id:person.id })}}"
      enctype="multipart/form-data"
      data-progress-container="upload-progress">


      <div class="upload-container text-center">
        <div>
          <label
            for="photo-upload-file"
            class="photo-upload">
            <i class="bi bi-person-bounding-box"></i>
          </label>
          <span class="d-block">{{ 'Upload a photo or take a selfie'|trans }}</span>
        </div>

        <input
          id="photo-upload-file"
          style="display:none;"
          type="file"
          name="file"
          accept="image/jpeg, image/png, image/gif"
          data-error-header="{{ 'Error'|trans }}"
          data-error-wrong-type="{{ 'Wrong file type, please use JPG-files only!'|trans }}"
          data-error-to-big="{{ 'File to large!'|trans }}"
          data-file-mode="insert" />
      </div>
      <div
        id="upload-progress"
        class="progress photocommerce-photo-progress-container"
        style="display: none">
        <div
          class="progress-bar progress-bar-striped progress-bar-animated bg-danger"
          role="progressbar"
          aria-valuenow="0"
          aria-valuemin="0"
          aria-valuemax="100">
          <span class="status">0%</span>
        </div>
      </div>
    </form>
#}

    {# missing email verification #}
    {% if user.status == 'unlogged' %}
      <div class="row justify-content-center">
        <div class="col-12 col-md-10 col-lg-8">
          <div
            class="alert alert-warning my-3"
            role="alert">
            <div class="d-flex">
              <div class="flex-shrink-0">
                <i class="bi bi-exclamation-triangle px-1"></i>
              </div>
              <div class="flex-grow-1 ms-2">
                {{ 'meinidno.profile.missingEmailVerfication'|trans({
                  '%nutzerAuth_request%': path('app_api_profile_email_auth_request')
                }) }}
                <a
                  class="alert-link pointer ajax-action"
                  data-url="{{ path('app_api_profile_email_auth_request') }}">
                  {{ 'meinidno.profile.missingEmailVerfication.link.lbl'|trans }}
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endif %}

    <div class="row justify-content-center">
      <div class="col-12 col-md-10 col-lg-8">
        <h3>{{ 'meinidno.profile.title'|trans }}</h3>
        <p>{{ 'meinidno.profile.description'|trans }}</p>

        <div class="row mt-3">
          <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
            <div class="d-grid mb-3">
              <button
                type="button"
                class="btn btn-outline-dark ajax-modal"
                data-url="{{ path('app_person_edit', { id:person.id }) }}">
                {{ 'profile.edit.lbl'|trans }}
              </button>
            </div>
          </div>
          <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
            <div class="d-grid mb-3">
              <button
                type="button"
                class="btn btn-outline-dark ajax-modal"
                data-url="{{ path('app_account_edit') }}">
                {{ 'account.edit.lbl'|trans }}
              </button>
            </div>
          </div>
          <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
            <div class="d-grid mb-3">
              <a
                class="btn btn-outline-dark"
                href="{{ path('app_account_delete') }}">
                {{ 'profile.delete.lbl'|trans }}
              </a>
            </div>
          </div>

          <div class="col-12 col-lg-8 col-xl-6">
            {# @TODO: Find a better solution for this div have btn look w/o hover! #}
            <div class="d-grid mb-3 btn border-{{ user.sichtbar == true ? 'dark' : 'dark' }}">
              <form
                role="form"
                action="{{ path('app_api_profile_pass_enable', { id: user.id }) }}"
                method="post"
                data-callback="pass_enable"
                class="">
                <div class="form-check form-check-inline form-switch">
                  <input
                    type="hidden"
                    name="sichtbar"
                    value="0" />
                  <label
                    class="form-check-label text-dark pointer"
                    for="fldPassEnable">{{ 'meinidno.profile.check'|trans }}
                    <span class="icon">{{ user.sichtbar == true
                      ? '<i class="bi bi-check-circle text-success ps-1"></i>'
                      : '<i class="bi bi-exclamation-triangle text-warning ps-1"></i>'
                    }}</span>
                  </label>
                  <input
                    type="checkbox"
                    id="fldPassEnable"
                    class="form-check-input"
                    name="sichtbar"
                    value="1"
                    role="switch"
                    {{ user.sichtbar == true ? 'checked="checked"' }}
                    data-icon-on="bi bi-check-circle text-success ps-1"
                    data-icon-off="bi bi-exclamation-triangle text-warning ps-1"
                    autocomplete="off" />
                  <input
                    type="hidden"
                    name="token"
                    value="{{ csrf_token('pass_enable') }}"/>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    {# id number #}
    <div class="row my-4">
      <div class="col-12 col-md-10 offset-md-1 col-lg-8 offset-lg-2">
        <h3>{{ 'meinidno.idno.title'|trans }}</h3>
        <p>{{ 'meinidno.idno.description'|trans }}</p>
        <div
          id="toolbarItems"
          class="d-none">
          <button
            type="button"
            class="btn btn-sm btn-outline-success mx-1 ajax-modal"
            data-url="{{ path('app_items_new', { personId:person.id }) }}">
            <i class="{{ settings.buttons.new }}"></i>
            {{ 'items.action.new.lbl'|trans }}
          </button>
        </div>
        <table
          id="tableItems"
          class="d-none"
          data-toggle="table"
          data-classes="table table-sm table-hover"
          data-toolbar="#toolbarItems"
          data-locale="{{ language }}"
          data-loading-template="loadingTemplate"
          data-buttons-class="outline-dark btn-sm"
          data-mobile-responsive="true"
          data-show-refresh="false"
          data-url="{{ path('app_api_items_read', { personId:person.id }) }}"
          data-ll-active="{{ 'active'|trans() }}"
          data-ll-inactive="{{ 'inactive'|trans() }}">
          <thead class="bg-light">
            <tr>
              <th
                data-field="idNo"
                data-formatter="window.formatter.item.idno">{{ 'items.table.idNo.lbl'|trans }}</th>
              <th data-field="anbringung">{{ 'items.table.anbringung.lbl'|trans }}</th>
              <th
                data-field="noStatus"
                data-formatter="window.formatter.item.status">{{ 'items.table.noStatus.lbl'|trans }}</th>
              <th data-field="registriertDatum">{{ 'items.table.aktiviertDatum.lbl'|trans }}</th>
              <th
                data-width="100"
                data-align="right"
                data-field="operate"
                data-formatter="operateFormatter"
                data-events="window.table.events.default">{{ 'Aktion'|trans }}</th>
            </tr>
          </thead>
        </table>
      </div>
    </div>

    {# contacts #}
    <div class="row my-4">
      <div class="col-12 col-md-10 offset-md-1 col-lg-8 offset-lg-2">
        <h3>{{ 'meinidno.contact.title'|trans }}</h3>
        <p>{{ 'meinidno.contact.description'|trans }}</p>
        <div
          id="toolbarContacts"
          class="d-none">
          <button
            type="button"
            class="btn btn-sm btn-outline-success mx-1 ajax-modal"
            data-url="{{ path('app_contacts_new', { personId:person.id }) }}">
            <i class="{{ settings.buttons.new }}"></i>
            {{ 'contacts.action.new.lbl'|trans }}
          </button>
        </div>
        <table
          id="tableContacts"
          class="d-none"
          data-toggle="table"
          data-classes="table table-sm table-hover"
          data-toolbar="#toolbarContacts"
          data-locale="{{ language }}"
          data-loading-template="loadingTemplate"
          data-buttons-class="outline-dark btn-sm"
          data-mobile-responsive="true"
          data-show-refresh="false"
          data-url="{{ path('app_api_contacts_read', { personId:person.id }) }}">
          <thead class="bg-light">
            <tr>
              <th data-field="contactname">{{ 'contact.table.contactname.lbl'|trans }}</th>
              <th data-field="telefon">{{ 'contact.table.telefon.lbl'|trans }}</th>
              <th data-field="beziehung">{{ 'contact.table.beziehung.lbl'|trans }}</th>
              <th
                data-width="100"
                data-align="right"
                data-field="operate"
                data-formatter="operateFormatter"
                data-events="window.table.events.default">{{ 'Aktion'|trans }}</th>
            </tr>
          </thead>
        </table>
      </div>
    </div>
  </div>
{% endblock %}
